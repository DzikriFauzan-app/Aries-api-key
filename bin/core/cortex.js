const natural = require('natural');

class AriesCortex {
    constructor() {
        console.log("[CORTEX]    ðŸ§  Aries Native Brain: INITIALIZING...");
        
        // 1. MEMBANGUN JARINGAN SYARAF (CLASSIFIER)
        // Ini adalah tempat Aries "Belajar" membedakan tugas
        this.classifier = new natural.BayesClassifier();
        
        // 2. MENANAMKAN KECERDASAN DASAR (Latih Otak Aries)
        this.trainBrain();
        
        console.log("[CORTEX]    ðŸ§  Sovereignty: 100% (No External API)");
    }

    trainBrain() {
        // AJARI ARIES MEMAHAMI KONTEKS (Tanpa Internet)
        
        // Konteks: FEAC (Perbaikan Error)
        this.classifier.addDocument('error bug fix crash', 'feac_task');
        this.classifier.addDocument('repair system loop', 'feac_task');
        
        // Konteks: NEO ENGINE (Game Logic)
        this.classifier.addDocument('spawn enemy level stats', 'neo_task');
        this.classifier.addDocument('generate map rendering', 'neo_task');
        
        // Konteks: WEB/CLIENT
        this.classifier.addDocument('create content article', 'web_task');
        this.classifier.addDocument('user login auth', 'web_task');

        this.classifier.train();
    }

    process(input, context) {
        // OTAK BERPIKIR SENDIRI DI SINI
        const intent = this.classifier.classify(input);
        
        console.log(`[CORTEX]    âš¡ Thinking... Intent detected: [${intent}]`);

        // EKSEKUSI BERDASARKAN KEMAMPUAN SENDIRI
        if (intent === 'feac_task') {
            return this.processFeac(input);
        } else if (intent === 'neo_task') {
            return this.processNeo(input);
        } else if (intent === 'web_task') {
            return this.processWeb(input);
        } else {
            return { 
                status: "processed", 
                type: "general_logic", 
                output: `Aries Logic Core processed: "${input}"` 
            };
        }
    }

    // --- KEMAMPUAN SPESIFIK (MODUL INTERNAL) ---

    processFeac(input) {
        // Logika internal FEAC
        return {
            module: "FEAC",
            diagnosis: "System Scan Complete",
            action: "Auto-Correction Executed",
            timestamp: Date.now()
        };
    }

    processNeo(input) {
        // Logika internal Game Engine
        return {
            module: "NEO_ENGINE",
            entity: "Enemy_Level_5",
            hp: 1000,
            behavior: "Aggressive",
            render_instruction: "Vector3(10, 0, 10)"
        };
    }

    processWeb(input) {
        // Logika internal Content Generator
        return {
            module: "WEB_GEN",
            content: `<h1>Generated by Aries</h1><p>Processed locally on Termux.</p>`,
            meta: "SEO Optimized"
        };
    }
}

module.exports = { AriesCortex };
